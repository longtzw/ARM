# 第2章 ARM指令分类及其寻址方式

## 2.1 ARM指令集概要介绍

### 2.1.1 ARM指令的分类

ARM指令集可以分为跳转指令、数据处理指令、程序状态寄存器(PSR)传输指令、Load/Store指令、协处理器指令和异常中断产生指令6类。

### 2.1.2 ARM指令的一般编码格式

一条典型的ARM指令语法格式如下所示：

```
<opcode>{<cond>}{S} <Rd>,<Rn>,<shifter_operand>
```

其中：

- opcode 是指令助记符
- code 表示指令执行的条件
- S 决定指令的操作是否影响CPSR的值
- Rd 表示目标寄存器
- Rn 表示包含第1个操作数的寄存器
- shifter_operand 表示第2个操作数

## 2.2 ARM指令的寻址方式

### 2.2.1 数据处理指令的操作数的寻址方式

shifter_operand 通常有下面3种格式：

- 立即数方式(并不是每个32位的常数都是合法的立即数，immediate=immed_8循环右移(2*rotate_imm))
- 寄存器方式
- 寄存器移位方式，具体的移位(或循环移位)的方式有下面几种：
	+ ASR 算术右移
	+ LSL 逻辑左移
	+ LSR 逻辑右移
	+ ROR 循环右移
	+ RRX 扩展的循环右移

下面是一些寄存器移位方式的操作数示例：

```
MOV R0,R1,LSL #3         ;R0=R1*(2^3)
ADD R0,R1,LSL #3         ;R0=R1+R1*(2^3)
SUB R0,R1,R2,LSR #4      ;R0=R1-R2/(2^4)
MOV R0,R1,ROR R2         ;R0=R1循环右移R2位
```

### 2.2.2 字及无符号字节的Load/Store指令的寻址方式

Load 指令用于从内存中读取数据放入寄存器中；Store指令用于将寄存器中的数据保存到内存。

各种类型的Load/Store指令的寻址方式由两部分组成，基址寄存器+地址偏移量。基址寄存器可以为任何一个通用寄存器，地址偏移量可以有以下3种格式：

- 立即数
- 寄存器(值)
- 寄存器及一个移位常数，寄存器中的数值可以根据指令中的移位标志及移位常数作一定的移位操作，生成一个地址偏移量

